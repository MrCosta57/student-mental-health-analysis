# Questions

1) How to display categorical data? (talk about the proposed plot)
 -> try tables (mosaicplot) 3x3 con aggregazioni da 4 a 8 etc
3) Residual plot for categorical data seems bad always
2) How to check assumption on LDA/QDA? Use entropy?
3) Can I use non linear models? (probably not due to all categories)
4) Can I add numerical predictors? (use ordinal variables as numbers starting from 0?) 


Maximize sensitivity (true positive rate)

binamial ditrib con dim 10 (scaling data, e.g if they are from 6,16 --> 0,10) for response (glm with 2col [score, 10-score]~x1+x2+.. ) --> glm(cbind(score, 10-score)~x1+x2+.., family=binomial) #logistic regr for response
or lin regr for interpreting the coefficients

Compare w.r.t naive pred that use only the freq of the predictors
(es sum of error etc)
(error rate: 1-accuracy)
(naive classifier that reply only false have an error of false_var/tot_var)


Aggregate if too few observation for some classes
model Beta



# TODO

Furthermore, given the numerous levels associated with the symptom variables, a decision was made to categorize them into three tiers: "Low", "Medium", and "High". As for the `suicide` variable, it will be converted into a binary variable. This transformation is necessary to frame the problem as a classification task, thereby making the corresponding model more applicable for prediction. Typically, predicting an ordinal response variable would require different models, which are less commonly utilized.


It's crucial to mention that in these instances, the partitions are not uniformly distributed, and the split points are determined based on varying criteria:

TODO MODIFY THE CRITERIA HERE
- For the variable `suicide`, a value within the range [4, 10) corresponds to `FALSE`, while the interval [10, 17) corresponds to `TRUE`. These thresholds are set to align with the data distribution, where the majority of values fall within the first range, which is larger than the second. This approach ensures that only the most severe symptom values are classified as highly serious.

- For the predictor `internet_addiction`, the thresholds are established as follows: [5, 11) for `Low`, [11, 16) for `Medium`, and [16, 20) for `High`. The `Low` range is the most extensive, reflecting the previous assertion that empirically in medicine lower values are less significant compared to medium or higher ones.

- The remaining variables (`psychiatric_symptoms`, `dependence`, `impulsivity`, `compulsion`, `sleeping_disturbance`, `hostile_aggression`, `self_injury_behaviors`, and `eating_problems`) are categorized in a similar manner, with the thresholds set based on the distribution of the data and the clinical significance of the symptoms.


### Different model definition
Try to exploit better the informations provided by the original numeric scale of suicide.
For the binomial families the response can be specified in both ways:

As a factor: ‘success’ is interpreted as the factor not having the first level (and hence usually of having the second level).

As a two-column integer matrix: the first column gives the number of successes and the second the number of failures.
```{r}
df$scaled_suicide <- scaled_suicide
mod_succ_fail_formula<-formula(
  paste(
  "cbind(scaled_suicide, (max(scaled_suicide) - scaled_suicide)) ~"
  paste(extract_predictors_in_vec(mod_step_bic$formula, general_cols), collapse = " + "),
  " + ",
  paste(extract_predictors_in_vec(mod_step_bic$formula, symptoms_cols), collapse = "+"))
)

mod_succ_fail <- glm(mod_succ_fail_formula,
  family = "binomial",
  method = "brglmFit"
  data = subset(df, select = -suicide)[idx, ]
)
summary(mod_succ_fail)


# Restore previous state
df$scaled_suicide <- NULL
```

```{r message=FALSE, warning=FALSE}
probs_succ_fail <- predict(mod_succ_fail, newdata = df_test, type = "response")
roc_succ_fail <- roc(df_test$suicide ~ probs_succ_fail, plot = TRUE, print.auc = TRUE)
coords_succ_fail <- coords(roc_succ_fail, x = "best", ret = c("threshold", "specificity", "sensitivity", "accuracy", "tn", "tp", "fn", "fp"))
print(coords_succ_fail)
```



<!-- ## Category aggregation -->
<!-- Due to the discrete nature of the symptmoms numeric predictor, an attempt to aggregate them in 3 categories is performed. Specifically: -->

<!-- - For the predictor `internet_addiction`, the thresholds are established as follows: [5, 11) for `Low`, [11, 16) for `Medium`, and [16, 20) for `High`. The `Low` range is the most extensive, reflecting the previous assertion that empirically in medicine lower values are less significant compared to medium or higher ones. -->

<!-- - The remaining variables (`psychiatric_symptoms`, `dependence`, `impulsivity`, `compulsion`, `sleeping_disturbance`, `hostile_aggression`, `self_injury_behaviors`, and `eating_problems`) are categorized in a similar manner, with the thresholds set based on the distribution of the data and the clinical significance of the symptoms. -->

<!-- ```{r} -->
<!-- df_agg <- data.frame(df) -->
<!-- df_agg[["internet_addiction"]] <- reduce_df_categories_to3(df_agg, "internet_addiction", c(11, 16), c("Low", "Medium", "High")) -->

<!-- for (col in symptoms_cols[-6]){ -->
<!--   df_agg[[col]] <- reduce_df_categories_to3(df_agg, col, c(8, 12), c("Low", "Medium", "High")) -->
<!-- } -->
<!-- summary(df_agg[,symptoms_cols]) -->

<!-- df_agg_train <- df_agg[idx,] -->
<!-- df_agg_test <- df_agg[-idx,] -->
<!-- mod_agg <- glm(suicide~., data=df_agg_train, family="binomial") -->
<!-- mod -->
<!-- ``` -->
